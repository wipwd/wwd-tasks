<mat-tab-group>

  <mat-tab *ngFor="let ledger of getLedgers()">

    <ng-template mat-tab-label>
      {{ledger.label}} {{getLedgerSize(ledger.name)|async}}
    </ng-template>
    <ng-template matTabContent>

      <!-- options expansion panel -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <div fxLayout="row" fxLayoutAlign="space-between center"
                style="width: 100%">
              <!-- filter button -->
              <div fxLayout="row" fxLayoutAlign="start center">
                <mat-icon>filter_list</mat-icon>
                <span style="padding-left: 10px;">Options</span>
              </div>

              <div fxLayout="row"> <!-- filters list -->
                <span *ngFor="let filter of getFilters()|keyvalue"
                    style="padding-left: 10px;">
                  <strong>{{filter.key}}: </strong>
                  {{filter.value}}
                </span>
                <div *ngIf="hasFilter()"
                    style="padding-left: 10px; padding-right: 10px;">
                  <mat-divider [vertical]="true" style="height: 24px">
                  </mat-divider>
                </div>
                <span>
                  <strong>sort by: </strong> {{getSorting().sortby}}
                  <strong *ngIf="getSorting().ascending">ascending</strong>
                  <strong *ngIf="!getSorting().ascending">descending</strong>
                </span>
              </div>

              <span></span>

            </div>
          </mat-panel-title>
        </mat-expansion-panel-header>
        
        <!-- panel contents -->
        <div fxLayout="row" fxLayoutAlign="start center"
            style="margin-top: 10px">

          <!-- filters -->
          <div fxLayout="column" fxLayoutAlign="center start">

            <span><strong>Filters</strong></span>
            <div fxLayout="row" fxLayoutAlign="start center"
                [formGroup]="filter_form_group">
              <!-- filter by project -->
              <mat-form-field>
                <mat-label>Project</mat-label>
                <mat-select multiple formControlName="project"
                    (selectionChange)="projectFilterChanged($event)">
                  <mat-option
                      *ngFor="let project of getProjects()|async"
                      [value]="project">
                    {{project}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <span style="width: 40px"></span>
              <!-- filter by title -->
              <mat-form-field style="width: 30em">
                <mat-label>Title</mat-label>
                <input matInput formControlName="title"
                    (keyup)="titleFilterChanged($event)"/>
              </mat-form-field>
            </div>
          </div> <!-- /filters -->

          <span style="width: 40px"></span> <!-- spacer -->
          <div>
            <mat-divider [vertical]="true" style="height: 86px"></mat-divider>
          </div>
          <span style="width: 40px"></span> <!-- spacer -->

          <!-- sort -->
          <div fxLayout="column" fxLayoutAlign="center start">

            <span><strong>Sort By</strong></span>
            <div fxLayout="row" fxLayoutAlign="start center"
                [formGroup]="sorting_form_group">
              <!-- sort by field -->
              <mat-form-field>
                <mat-label>Field</mat-label>
                <mat-select formControlName="field"
                    (selectionChange)="sortingFieldChanged($event)">
                  <mat-option value="title">Title</mat-option>
                  <mat-option value="creation">Creation</mat-option>
                  <mat-option value="duration">Duration</mat-option>
                  <mat-option value="project">Project</mat-option>
                </mat-select>
              </mat-form-field>
              <span style="width: 40px"></span> <!-- spacer -->
              <!-- ascending / descending -->
              <mat-form-field>
                <mat-label>Direction</mat-label>
                <mat-select formControlName="direction"
                    (selectionChange)="sortingDirectionChanged($event)">
                  <mat-option value="asc">Ascending</mat-option>
                  <mat-option value="desc">Descending</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
      
        </div> <!-- /panel contents-->

      </mat-expansion-panel>
      
      <app-task-ledger [ledger]="ledger.name"
          [filters]="filters$" [sorting]="sorting$">
      </app-task-ledger>
    </ng-template>
  </mat-tab>

</mat-tab-group>